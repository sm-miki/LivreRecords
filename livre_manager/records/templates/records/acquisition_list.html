{% extends 'records/base.html' %}
{% load static %}
{% load record_extras %}

{% block title %}入手記録一覧{% endblock %}

{% block breadcrumbs %}
{% endblock %}

{% block content %}

<div class="content-header">
	<div class="content-title">
		入手記録一覧
	</div>
</div>

<div class="control-bar inline-flow">
	<a href="{% url 'records:acquisition_new' %}" class="balloon-button">
		<img src="{% static 'records/images/plus_circle_icon.png' %}" alt="plus" class="balloon-icon">
		新規登録
	</a>
</div>

<div class="item-container">
{% for record in records %}
	<div class="item-card">
		<div class="inline">
			<div class="item-type-symbol {{ record.acquisition_type }}-acquisition-type">
				{{ record.acquisition_type_label }}
			</div>
			<div class="text-item">
				{% spaceless %}
				<a href="{% url 'records:acquisition_detail' record.id %}">
					{% if record.acquisition_date %}
						{{ record.acquisition_date_str }} {{record.acquisition_date_info.tz_abbr}}
					{% else %}
						(日時未登録)
					{% endif %}
					 – {{ record.store_name |default:"(店舗未登録)" }}
				</a>
				{% endspaceless %}
			</div>
		</div>
		<div class="inline-flow">
			<div class="text-item">
				<span class="label">取引番号</span>: {{ record.transaction_number | default:"-" }}
			</div>
		</div>
		<div class="inline-flow">
			<div class="text-item">
				{{ record.total_quantity }}点
				{% format_price_and_tax record.total record.subtotal record.tax record.currency_code as price_str %}
				{{ price_str | default:"(金額未設定)" }}
			</div>
		</div>
		<div class="inline-flow card-control">
			<button type="submit" class="btn-primary" onclick="location.href='{% url 'records:acquisition_edit' record.pk %}'">
				編集
			</button>
			<form action="{% url 'records:acquisition_delete' record.pk %}" method="post" style="display: inline;">
				{% csrf_token %}
				<button type="submit" class="btn btn-danger" onclick="return confirm('本当にこの入手記録を削除しますか？ この操作は取り消せません。');">
					削除
				</button>
			</form>
		</div>
	</div>
{% empty %}
	<div class="item-card">該当する記録がありません。</div>
{% endfor %}
</div>

{% endblock %}
